from control.matlab import *

def model_fmu_dynamics():
    """
    系统动态特性模型:GPC控制器内置的模型
    Returns:

    """
    # 传递函数
    s = tf("s")
    # 预测时域Np
    Np = 2400
    # 控制时域Nc
    Nc = 600

    # EER模型: Q=6000kW
    tf11_1 = ((-0.6338 * s ** 3 - 0.0001282 * s ** 2 - 2.392 * 10 ** (-7) * s + 4.303 * 10 ** (-12)) /
              (s ** 3 + 0.0004849 * s ** 2 + 2.318 * 10 ** (-7) * s + 3.516 * 10 ** (-11)))
    tf12_1 = ((-0.0001844 * s ** 3 - 1.061 * 10 ** (-6) * s ** 2 - 1.887 * 10 ** (-10) * s - 3.516 * 10 ** (-14)) /
              (s ** 3 + 0.00269 * s ** 2 + 1.648 * 10 ** (-6) * s + 3.413 * 10 ** (-10)))
    tf13_1 = (-0.0005591 * s - 8.011 * 10 ** (-5)) / (s + 0.1454)
    tf14_1 = (0.0003507 * s + 1.023 * 10 ** (-6)) / (s + 0.001917)
    # Tei模型: Q=6000kW
    tf21_1 = ((0.0006281) / (s + 0.0006338)) * (1 / (9000 * s + 1))
    tf22_1 = ((-0.002294 * s - 1.559 * 10 ** (-6)) / (s + 0.0004605)) * (1 / (3600 * s + 1))
    tf23_1 = 0 / 1
    tf24_1 = 0 / 1
    # 6000kW模型列表
    tf1_EER_list = [[tf11_1, tf12_1, tf13_1, tf14_1]]
    tf1_Tei_list = [[tf21_1, tf22_1, tf23_1, tf24_1]]
    tf1_list = [tf1_EER_list[0], tf1_Tei_list[0]]
    # 6000kW权值列表
    # only EER
    r1_EER_1 = 1
    r2_EER_1 = 1
    r3_EER_1 = 1
    r4_EER_1 = 1
    r1_EER_list = [r1_EER_1, r2_EER_1, r3_EER_1, r4_EER_1]
    q1_EER_1 = 1
    q1_EER_list = [q1_EER_1]
    # EER + Tei
    r1_1 = 100
    r2_1 = 0.01
    r3_1 = 60
    r4_1 = 0.01
    r1_list = [r1_1, r2_1, r3_1, r4_1]
    q1_1 = 1200
    q2_1 = 370
    q1_list = [q1_1, q2_1]

    # EER模型: Q=8500kW
    tf11_2 = ((-0.5741 * s ** 3 - 0.0001728 * s ** 2 - 5.437 * 10 ** (-7) * s + 1.534 * 10 ** (-11)) /
              (s ** 3 + 0.000801 * s ** 2 + 5.575 * 10 ** (-7) * s + 1.312 * 10 ** (-10)))
    tf12_2 = ((-0.0007332 * s ** 2 - 3.335 * 10 ** (-6) * s - 4.904 * 10 ** (-10)) /
              (s ** 2 + 0.002495 * s + 1.309 * 10 ** (-6)))
    tf13_2 = (-0.0006696 * s - 1.116 * 10 ** (-6)) / (s + 0.001653)
    tf14_2 = (0.001878 * s + 3.229 * 10 ** (-6)) / (s + 0.001612)
    # Tei模型: Q=8500kW
    tf21_2 = ((0.5605 * s + 0.0008798) / (s + 0.0008858)) * (1 / (7200 * s + 1))
    tf22_2 = ((-0.0006182 * s - 2.374 * 10 ** (-6)) / (s + 0.0008302)) * (1 / (1800 * s + 1))
    tf23_2 = 0 / 1
    tf24_2 = 0 / 1
    # 8500kW模型列表
    tf2_EER_list = [[tf11_2, tf12_2, tf13_2, tf14_2]]
    tf2_Tei_list = [[tf21_2, tf22_2, tf23_2, tf24_2]]
    tf2_list = [tf2_EER_list[0], tf2_Tei_list[0]]
    # 8500kW权值列表
    # only EER
    r1_EER_2 = 1
    r2_EER_2 = 1
    r3_EER_2 = 1
    r4_EER_2 = 1
    r2_EER_list = [r1_EER_2, r2_EER_2, r3_EER_2, r4_EER_2]
    q1_EER_2 = 1
    q2_EER_list = [q1_EER_2]
    # EER + Tei
    r1_2 = 100
    r2_2 = 0.01
    r3_2 = 60
    r4_2 = 0.01
    r2_list = [r1_2, r2_2, r3_2, r4_2]
    q1_2 = 1200
    q2_2 = 370
    q2_list = [q1_2, q2_2]

    # EER模型: Q=10000kW
    tf11_3 = ((-0.3761 * s ** 3 - 9.365 * 10 ** (-5) * s ** 2 - 5.2 * 10 ** (-7) * s + 3.156 * 10 ** (-11)) /
              (s ** 3 + 0.0009634 * s ** 2 + 7.588 * 10 ** (-7) * s + 2.16 * 10 ** (-10)))
    tf12_3 = (-0.002567 * s - 6.097 * 10 ** (-7)) / (s + 0.0006247)
    tf13_3 = (-0.0008778 * s - 7.121 * 10 ** (-5)) / (s + 0.08116)
    tf14_3 = (0.002128 * s + 4.292 * 10 ** (-6)) / (s + 0.001901)
    # Tei模型: Q=10000kW
    tf21_3 = ((0.1352 * s + 0.0009912) / (s + 0.0009971)) * (1 / (5400 * s + 1))
    tf22_3 = ((-0.001515 * s - 3.606 * 10 ** (-6)) / (s + 0.001535)) * (1 / (1800 * s + 1))
    tf23_3 = 0 / 1
    tf24_3 = 0 / 1
    # 10000kW模型列表
    tf3_EER_list = [[tf11_3, tf12_3, tf13_3, tf14_3]]
    tf3_Tei_list = [[tf21_3, tf22_3, tf23_3, tf24_3]]
    tf3_list = [tf3_EER_list[0], tf3_Tei_list[0]]
    # 10000kW权值列表
    # only EER
    r1_EER_3 = 1
    r2_EER_3 = 1
    r3_EER_3 = 1
    r4_EER_3 = 1
    r3_EER_list = [r1_EER_3, r2_EER_3, r3_EER_3, r4_EER_3]
    q1_EER_3 = 1
    q3_EER_list = [q1_EER_3]
    # EER + Tei
    r1_3 = 45
    r2_3 = 0.01
    r3_3 = 40
    r4_3 = 100
    r3_list = [r1_3, r2_3, r3_3, r4_3]
    q1_3 = 650
    q2_3 = 390
    q3_list = [q1_3, q2_3]

    # EER模型: Q=12500kW
    tf11_4 = ((0.2849 * s + 0.000217) / (s + 0.001123)) * (1 / (5400 * s + 1))
    tf12_4 = (-0.0029 * s - 9.89 * 10 ** (-7)) / (s + 0.001077)
    tf13_4 = (-0.0008824 * s - 1.595 * 10 ** (-6)) / (s + 0.001802)
    tf14_4 = (0.001584 * s + 4.657 * 10 ** (-6)) / (s + 0.00286)
    # Tei模型: Q=12500kW
    tf21_4 = ((0.8398 * s + 0.001279) / (s + 0.001285)) * (1 / (5400 * s + 1))
    tf22_4 = (-2.206 * 10 ** (-6)) / (s + 0.001096)
    tf23_4 = 0 / 1
    tf24_4 = 0 / 1
    # 12500kW模型列表
    tf4_EER_list = [[tf11_4, tf12_4, tf13_4, tf14_4]]
    tf4_Tei_list = [[tf21_4, tf22_4, tf23_4, tf24_4]]
    tf4_list = [tf4_EER_list[0], tf4_Tei_list[0]]
    # 12500kW权值列表
    # only EER
    r1_EER_4 = 1
    r2_EER_4 = 1
    r3_EER_4 = 1
    r4_EER_4 = 1
    r4_EER_list = [r1_EER_4, r2_EER_4, r3_EER_4, r4_EER_4]
    q1_EER_4 = 1
    q4_EER_list = [q1_EER_4]
    # EER + Tei
    r1_4 = 330
    r2_4 = 920
    r3_4 = 1000
    r4_4 = 0.01
    r4_list = [r1_4, r2_4, r3_4, r4_4]
    q1_4 = 6600
    q2_4 = 10000
    q4_list = [q1_4, q2_4]

    # 模型列表
    Np_list = [Np, Np, Np, Np]
    Nc_list = [Nc, Nc, Nc, Np]
    model_EER_list = [tf1_EER_list, tf2_EER_list, tf3_EER_list, tf4_EER_list]
    model_Tei_list = [tf1_Tei_list, tf2_Tei_list, tf3_Tei_list, tf4_Tei_list]
    model_list = [tf1_list, tf2_list, tf3_list, tf4_list]
    r_EER_list = [r1_EER_list, r2_EER_list, r3_EER_list, r4_EER_list]
    q_EER_list = [q1_EER_list, q2_EER_list, q3_EER_list, q4_EER_list]
    r_Tei_list = []
    q_Tei_list = []
    r_list = [r1_list, r2_list, r3_list, r4_list]
    q_list = [q1_list, q2_list, q3_list, q4_list]
    # 每个模型对应的制冷功率Q的列表
    Q_model_list = [6000, 8500, 10000, 12500]

    # 返回结果
    return (Q_model_list, model_list, model_EER_list, model_Tei_list, Np_list, Nc_list, r_list, q_list,
            r_EER_list, q_EER_list, r_Tei_list, q_Tei_list)


def plant_fmu_dynamics():
    """
    系统动态特性模型:被控对象当前情况下实际的传递函数模型
    用于测试MMGPC控制器
    Returns:

    """
    # 传递函数
    s = tf("s")

    # EER模型: Q=14000kW
    tf11_1 = ((0.2072 * s ** 3 - 0.00235 * s ** 2 + 5.752 * 10 ** (-7) * s + 3.254 * 10 ** (-10)) /
              (s ** 3 + 0.002893 * s ** 2 + 3.411 * 10 ** (-6) * s + 1.459 * 10 ** (-9)))
    tf12_1 = ((-0.003551 * s ** 3 - 5.512 * 10 ** (-7) * s ** 2 - 3.568 * 10 ** (-9) * s - 3.455 * 10 ** (-13)) /
              (s ** 3 + 0.0009707 * s ** 2 + 1.519 * 10 ** (-6) * s + 4.083 * 10 ** (-10)))
    tf13_1 = (-0.0006938 * s - 0.1707) / (s + 246.1)
    tf14_1 = (0.002167 * s + 5.138 * 10 ** (-6)) / (s + 0.002318)
    # Tei模型: Q=14000kW
    tf21_1 = ((0.3724 * s + 0.001391) / (s + 0.001397)) * (1 / (3600 * s + 1))
    tf22_1 = ((-0.00169 * s ** 2 - 9.063 * 10 ** (-7) * s - 1.064 * 10 ** (-9)) /
              (s ** 2 + 0.001501 * s + 5.937 * 10 ** (-7))) * (1 / (1800 * s + 1))
    tf23_1 = 0 / 1
    tf24_1 = 0 / 1
    # 14000kW模型列表
    tf1_EER_list = [[tf11_1, tf12_1, tf13_1, tf14_1]]
    tf1_Tei_list = [[tf21_1, tf22_1, tf23_1, tf24_1]]
    tf1_list = [tf1_EER_list[0], tf1_Tei_list[0]]

    # EER模型: Q=13500kW
    tf11_2 = ((0.1381 * s ** 3 - 9.295 * 10 ** (-5) * s ** 2 + 2.869 * 10 ** (-7) * s + 7.905 * 10 ** (-11)) /
              (s ** 3 + 0.001382 * s ** 2 + 1.261 * 10 ** (-6) * s + 3.692 * 10 ** (-10)))
    tf12_2 = ((-0.003387 * s ** 3 - 1.495 * 10 ** (-6) * s ** 2 - 2.909 * 10 ** (-9) * s - 4.057 * 10 ** (-13)) /
              (s ** 3 + 0.001105 * s ** 2 + 1.34 * 10 ** (-6) * s + 4.523 * 10 ** (-10)))
    tf13_2 = (-0.0007792 * s - 1.498 * 10 ** (-6)) / (s + 0.00192)
    tf14_2 = (0.001847 * s + 4.986 * 10 ** (-6)) / (s + 0.002635)
    # Tei模型: Q=13500kW
    tf21_2 = ((0.1703 * s + 0.001339) / (s + 0.001345)) * (1 / (3600 * s + 1))
    tf22_2 = ((-0.001725 * s ** 2 - 8.25 * 10 ** (-7) * s - 6.472 * 10 ** (-10)) /
              (s ** 2 + 0.0007444 * s + 3.438 * 10 ** (-7))) * (1 / (1800 * s + 1))
    tf23_2 = 0 / 1
    tf24_2 = 0 / 1
    # 13500kW模型列表
    tf2_EER_list = [[tf11_2, tf12_2, tf13_2, tf14_2]]
    tf2_Tei_list = [[tf21_2, tf22_2, tf23_2, tf24_2]]
    tf2_list = [tf2_EER_list[0], tf2_Tei_list[0]]

    # EER模型: Q=13000kW
    tf11_3 = ((0.288 * s + 0.0002332) / (s + 0.001141)) * (1 / (5400 * s + 1))
    tf12_3 = (-0.00317 * s - 9.47 * 10 ** (-7)) / (s + 0.001099)
    tf13_3 = (-0.0007782 * s - 0.001953) / (s + 2.51)
    tf14_3 = (0.001756 * s + 4.102 * 10 ** (-6)) / (s + 0.002276)
    # Tei模型: Q=13000kW
    tf21_3 = ((0.001206) / (s + 0.001212)) * (1 / (3600 * s + 1))
    tf22_3 = ((-0.001722 * s - 5.855 * 10 ** (-7)) / (s + 0.0002948)) * (1 / (1800 * s + 1))
    tf23_3 = 0 / 1
    tf24_3 = 0 / 1
    # 13000kW模型列表
    tf3_EER_list = [[tf11_3, tf12_3, tf13_3, tf14_3]]
    tf3_Tei_list = [[tf21_3, tf22_3, tf23_3, tf24_3]]
    tf3_list = [tf3_EER_list[0], tf3_Tei_list[0]]

    # EER模型: Q=11500kW
    tf11_4 = (1.932 * s + 0.0005462) / (s + 0.0003138)
    tf12_4 = (-0.002464 * s - 7.803 * 10 ** (-7)) / (s + 0.0008213)
    tf13_4 = (-0.0008618 * s - 0.006412) / (s + 7.442)
    tf14_4 = (0.001704 * s + 3.792 * 10 ** (-6)) / (s + 0.002138)
    # Tei模型: Q=11500kW
    tf21_4 = ((0.6184 * s + 0.0007326) / (s + 0.0008732)) * (1 / (5400 * s + 1))
    tf22_4 = ((-0.0017 * s - 4.36 * 10 ** (-6)) / (s + 0.001957)) * (1 / (1800 * s + 1))
    tf23_4 = 0 / 1
    tf24_4 = 0 / 1
    # 11500kW模型列表
    tf4_EER_list = [[tf11_4, tf12_4, tf13_4, tf14_4]]
    tf4_Tei_list = [[tf21_4, tf22_4, tf23_4, tf24_4]]
    tf4_list = [tf4_EER_list[0], tf4_Tei_list[0]]

    # EER模型: Q=10500kW
    tf11_5 = ((-0.315 * s ** 3 + 0.0004811 * s ** 2 - 1.144 * 10 ** (-6) * s + 1.079 * 10 ** (-10)) /
              (s ** 3 + 0.00187 * s ** 2 + 1.788 * 10 ** (-6) * s + 7.018 * 10 ** (-10)))
    tf12_5 = (-0.001812 * s - 4.912 * 10 ** (-7)) / (s + 0.0005669)
    tf13_5 = (-0.000934 * s - 0.002989) / (s + 3.204)
    tf14_5 = (0.002284 * s + 4.671 * 10 ** (-6)) / (s + 0.001888)
    # Tei模型: Q=10500kW
    tf21_5 = ((0.3901 * s + 0.001021) / (s + 0.001027)) * (1 / (5400 * s + 1))
    tf22_5 = ((-0.001519 * s - 3.358 * 10 ** (-6)) / (s + 0.001347)) * (1 / (1800 * s + 1))
    tf23_5 = 0 / 1
    tf24_5 = 0 / 1
    # 10500kW模型列表
    tf5_EER_list = [[tf11_5, tf12_5, tf13_5, tf14_5]]
    tf5_Tei_list = [[tf21_5, tf22_5, tf23_5, tf24_5]]
    tf5_list = [tf5_EER_list[0], tf5_Tei_list[0]]

    # EER模型: Q=9500kW
    tf11_6 = ((-0.4797 * s ** 3 - 0.0001238 * s ** 2 - 5.705 * 10 ** (-7) * s + 2.44 * 10 ** (-11)) /
              (s ** 3 + 0.0008757 * s ** 2 + 6.75 * 10 ** (-7) * s + 1.8 * 10 ** (-10)))
    tf12_6 = ((-0.002127 * s ** 2 - 3.23 * 10 ** (-5) * s - 7.191 * 10 ** (-9)) /
              (s ** 2 + 0.008468 * s + 7.648 * 10 ** (-6)))
    tf13_6 = (-0.0007311 * s - 0.001254) / (s + 1.691)
    tf14_6 = (0.002392 * s + 4.563 * 10 ** (-6)) / (s + 0.001751)
    # Tei模型: Q=9500kW
    tf21_6 = ((0.0009589) / (s + 0.0009644)) * (1 / (5400 * s + 1))
    tf22_6 = ((-0.001364 * s - 3.175 * 10 ** (-6)) / (s + 0.001276)) * (1 / (1800 * s + 1))
    tf23_6 = 0 / 1
    tf24_6 = 0 / 1
    # 9500kW模型列表
    tf6_EER_list = [[tf11_6, tf12_6, tf13_6, tf14_6]]
    tf6_Tei_list = [[tf21_6, tf22_6, tf23_6, tf24_6]]
    tf6_list = [tf6_EER_list[0], tf6_Tei_list[0]]

    # EER模型: Q=5500kW
    tf11_7 = ((-0.7935 * s ** 3 - 0.0001757 * s ** 2 - 2.886 * 10 ** (-7) * s + 3.702 * 10 ** (-12)) /
              (s ** 3 + 0.0004835 * s ** 2 + 2.277 * 10 ** (-7) * s + 3.41 * 10 ** (-11)))
    tf12_7 = ((0.0004839 * s ** 3 - 8.813 * 10 ** (-8) * s ** 2 + 1.509 * 10 ** (-9) * s - 1.063 * 10 ** (-13)) /
              (s ** 3 + 0.0009294 * s ** 2 + 2.292 * 10 ** (-6) * s + 7.281 * 10 ** (-10)))
    tf13_7 = (-0.0005655 * s - 5.113 * 10 ** (-5)) / (s + 0.09151)
    tf14_7 = (0.0003635 * s + 1.033 * 10 ** (-6)) / (s + 0.001855)
    # Tei模型: Q=5500kW
    tf21_7 = ((0.0006268) / (s + 0.0006324)) * (1 / (9000 * s + 1))
    tf22_7 = ((-0.002132 * s - 1.414 * 10 ** (-6)) / (s + 0.0004498)) * (1 / (3600 * s + 1))
    tf23_7 = 0 / 1
    tf24_7 = 0 / 1
    # 5500kW模型列表
    tf7_EER_list = [[tf11_7, tf12_7, tf13_7, tf14_7]]
    tf7_Tei_list = [[tf21_7, tf22_7, tf23_7, tf24_7]]
    tf7_list = [tf7_EER_list[0], tf7_Tei_list[0]]

    # EER模型: Q=5000kW
    tf11_8 = ((-0.5503 * s ** 3 - 9.265 * 10 ** (-5) * s ** 2 - 1.837 * 10 ** (-7) * s + 4.453 * 10 ** (-12)) /
              (s ** 3 + 0.0004485 * s ** 2 + 1.995 * 10 ** (-7) * s + 2.828 * 10 ** (-11)))
    tf12_8 = ((-0.0009989 * s ** 3 + 7.299 * 10 ** (-7) * s ** 2 - 3.159 * 10 ** (-9) * s + 2.808 * 10 ** (-14)) /
              (s ** 3 + 0.001604 * s ** 2 + 1.921 * 10 ** (-6) * s + 6.266 * 10 ** (-10)))
    tf13_8 = (-0.0006282 * s - 0.0001004) / (s + 0.1618)
    tf14_8 = (0.0138 * s + 1.773 * 10 ** (-5)) / (s + 0.000894)
    # Tei模型: Q=5000kW
    tf21_8 = ((0.2809 * s + 0.0005491) / (s + 0.0005542)) * (1 / (10800 * s + 1))
    tf22_8 = ((-0.000745 * s - 2.25 * 10 ** (-6)) / (s + 0.000565)) * (1 / (3600 * s + 1))
    tf23_8 = 0 / 1
    tf24_8 = 0 / 1
    # Tei模型: Q=5000kW
    tf8_EER_list = [[tf11_8, tf12_8, tf13_8, tf14_8]]
    tf8_Tei_list = [[tf21_8, tf22_8, tf23_8, tf24_8]]
    tf8_list = [tf8_EER_list[0], tf8_Tei_list[0]]

    # 模型列表
    plant_EER_list = [tf1_EER_list, tf2_EER_list, tf3_EER_list, tf4_EER_list,
                      tf5_EER_list, tf6_EER_list, tf7_EER_list, tf8_EER_list]
    plant_Tei_list = [tf1_Tei_list, tf2_Tei_list, tf3_Tei_list, tf4_Tei_list,
                      tf5_Tei_list, tf6_Tei_list, tf7_Tei_list, tf8_Tei_list]
    plant_list = [tf1_list, tf2_list, tf3_list, tf4_list, tf5_list, tf6_list, tf7_list, tf8_list]
    # 每个模型对应的制冷功率Q的列表
    Q_plant_list = [14000, 13500, 13000, 11500, 10500, 9500, 5500, 5000]

    # 返回结果
    return Q_plant_list, plant_list, plant_EER_list, plant_Tei_list